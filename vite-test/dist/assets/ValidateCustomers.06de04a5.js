import"./base.4dcf5096.js";import{E as L,a as N,v as j,b as R}from"./el-checkbox.16706080.js";import{c as g,b as T,a as P}from"./el-input.1f737f8f.js";import"./el-popper.a92d08b1.js";/* empty css                  */import{s as _}from"./api.f62c2e2b.js";import{_ as U}from"./plugin-vue_export-helper.f63bf49c.js";import{a as q}from"./index.301d88d0.js";import{d as H,W as J,A as o,y as M,ao as C,ay as O,b as a,aq as m,E as W,ap as G,at as K,N as Q,ar as E,aa as X,as as Y,i as Z}from"./index.5896ee19.js";import"./index.a6c5441b.js";const ee={class:"button-group"},te={style:{display:"flex","align-items":"center","justify-content":"center"}},ae=H({__name:"ValidateCustomers",setup(oe){const u=J({count:0,next:"null",previous:"null"}),v=o(!1),n=()=>{v.value=!v.value},h=o(),r=o(),i=o(!0),b=o(0),f=e=>{u.count=e.data.count,u.next=e.data.next,u.previous=e.data.previous,h.value=e.data.results,h.value.forEach(t=>{x.value.push(t.customer_photo)})},y=()=>{var e,t;((e=r.value)==null?void 0:e.getSelectionRows().length)!==0?(i.value=!1,b.value=(t=r.value)==null?void 0:t.getSelectionRows().length):i.value=!0},F=Z("reload",Function,!0),w=()=>{var e;n(),_.post("/validateCustomers",JSON.stringify({idList:(e=r.value)==null?void 0:e.getSelectionRows().map(t=>t.id)})).then(t=>{g.success({message:t.data.message}),F(),n()}).catch(t=>{g.error({message:t}),n()})},x=o([]),B=o(),z=e=>{B.value=e},c=o(30),S=o([30,50,100]),p=o();M(p,(e,t)=>{var d;(d=r.value)==null||d.scrollTo(0,0)});const D=()=>{n(),_.get(`/customers?pageSize=${c.value}&is_valided=0`).then(e=>{n(),f(e)}).catch(e=>{n()})},k=()=>{n(),_.get(`/customers?page=${p.value}&pageSize=${c.value}&is_valided=0`).then(e=>{n(),f(e)}).catch(e=>{n(),g.error(e.code)})};return _.get("/customers?is_valided=0").then(e=>{f(e)}).catch(e=>{g.error(e.code)}),(e,t)=>{const d=T,V=q,s=L,I=P,A=N,$=j;return C(),O(Q,null,[a(V,null,{default:m(()=>[E("div",ee,[a(d,{type:"primary",disabled:i.value,onClick:w},{default:m(()=>[X("\u901A\u8FC7 ("+Y(i.value?0:b.value)+")",1)]),_:1},8,["disabled"])])]),_:1}),W((C(),G(K(R),{data:h.value,ref_key:"tableInstance",ref:r,"max-height":"800","element-loading-text":"\u52A0\u8F7D\u4E2D",border:"",stripe:"",onSelectionChange:t[0]||(t[0]=l=>y())},{default:m(()=>[a(s,{type:"selection"}),a(s,{label:"Id",width:"70",height:"10",prop:"id",fit:"",align:"center"}),a(s,{prop:"customer_name",label:"\u5B66\u751F\u59D3\u540D",align:"center"}),a(s,{prop:"customer_photo",label:"\u5B66\u751F\u7167\u7247",align:"center"},{default:m(l=>[E("div",te,[a(I,{src:"/static/avatar/"+l.row.customer_photo,style:{height:"100px",width:"80px"},fit:"cover",lazy:!0,"preview-src-list":x.value,"initial-index":B.value,"z-index":5e3,"preview-teleported":"",onClick:ne=>z(l.$index)},null,8,["src","preview-src-list","initial-index","onClick"])])]),_:1}),a(s,{prop:"customer_id",label:"\u5B66\u751F\u8EAB\u4EFD\u8BC1\u53F7",align:"center"}),a(s,{prop:"parent_phone",label:"\u5BB6\u957F\u624B\u673A\u53F7",align:"center"}),a(s,{prop:"class_name",label:"\u5B66\u751F\u73ED\u7EA7",align:"center"}),a(s,{prop:"customer_logtime",label:"\u5B66\u751F\u767B\u8BB0\u65F6\u95F4",align:"center"})]),_:1},8,["data"])),[[$,v.value]]),a(A,{"current-page":p.value,"onUpdate:current-page":t[1]||(t[1]=l=>p.value=l),"page-size":c.value,"onUpdate:page-size":t[2]||(t[2]=l=>c.value=l),"page-sizes":S.value,total:u.count,layout:"total,prev, pager, next,jumper,sizes",background:"",onSizeChange:D,onCurrentChange:k},null,8,["current-page","page-size","page-sizes","total"])],64)}}}),me=U(ae,[["__scopeId","data-v-695d1d97"]]);export{me as default};
